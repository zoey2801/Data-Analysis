import pandas as pd
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
from sklearn import metrics
import allmodels 


data = pd.read_csv('data-test-clean22.csv')
X = data.iloc[:,:-1]
y = data.iloc[:,-1]
import time
start_time = time.time()


# classifier_dt = allmodels.DecisionTreeClassifier(max_depth = 24)
# classifier_dt = allmodels.classifier_dt.fit(X, y)

y_pred = allmodels.classifier_dt.predict(X)
# accuracy_dt_train = accuracy_score(y_test, y_pred_dt_train)
# print("Training set: ", accuracy_dt_train)
# cm_dt_train = metrics.confusion_matrix(y_test, y_pred_dt_train)
# cm_lr_display = ConfusionMatrixDisplay(cm_dt_train).plot()
# plt.show()
# #fit on testing

   
result = metrics.confusion_matrix(y, y_pred)
print("Decision Tree Confusion Matrix:")
print(result)
result1 = metrics.classification_report(y, y_pred)
print("Decision Tree Classification Report:",)
print (result1)
y_pred_dt_test = allmodels.classifier_dt.predict(X)
accuracy_dt_test = accuracy_score(y, y_pred)
print("Decision Tree accuracy testing set: ", accuracy_dt_test)
print("--- %s seconds ---" % (time.time() - start_time))

